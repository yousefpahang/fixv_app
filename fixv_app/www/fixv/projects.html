<!-- projects.html -->
{% extends "templates/web.html" %}
{% block page_content %}
<ul class="nav nav-pills justify-content-center mt-3 mb-4">
  <li class="nav-item">
    <a class="nav-link active" href="#">All Task</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">Current Task</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="#">Finished</a>
  </li>
</ul>
<div>

  <Button
  :variant="'solid'"
  theme="gray"
  size="sm"
  label="Button"
  :loading="false"
  :loadingText="null"
  :disabled="false"
  :link="null"
  id="filter-open"
>
  Open Tickets
</Button>
</div>
<div class="container">
    <div class="row">
        {% for project in projects %}

          <div class="col-md-6 col-lg-6 col-xl-6 col-xxl-3 mb-4 project" data-status="{{ project.status }}">
              <div class="card" >
                  <div class="card-header">
                      <h5 class="card-title mb-0">{{ project.project_name }} {{ project.status }}</h5>
                  </div>
                  <div class="card-body">
                      <div class="info-container">
                          <ul class="list-unstyled">
                            <li class="mb-3">
                              <span class="fw-medium me-2">Customer:</span>
                              <span>{{project.customer}}</span>
                            </li>
                            <li class="mb-3">
                              <span class="fw-medium me-2">Email:</span>
                              <span>vafgot@vultukir.org</span>
                            </li>
                            <li class="mb-3">
                              <span class="fw-medium me-2">Status:</span>
                              <span class="badge bg-label-success">{{project.status}}</span>
                            </li>
                            <li class="mb-3">
                              <span class="fw-medium me-2">Whatsapp:</span>
                              <span>{{project.custom_whatsapp}}</span>
                            </li>
                
                            <li class="mb-3">
                              <span class="fw-medium me-2">project.creation:</span>
                              <span>{{project.creation}}</span>
                            </li>
                            <li class="mb-3">
                              <span class="fw-medium me-2">Due Date:</span>
                              <span>{{project.expected_end_date}}</span>
                            </li>
                            <li class="mb-3">
                              <span class="fw-medium me-2">Percentage:</span>
                              <span>{{project.percent_complete}}</span>
                            </li>                          
                            
                          
                          </ul>

                        </div>
                      

                      {% if project.tasks %}  
                      
                      <ul>
                          {% for task in project.tasks %}
                              <li>{{ task.subject }} - 
                              {% if task.status == "Open" %}
                                  <span class="badge bg-success">
                              {% elif task.status == "Working" %}
                              <span class="badge bg-primary">
                              {% elif task.status == "Completed" %}
                              <span class="badge bg-info">
                              {% else %}
                                  <span class="badge bg-secondary">
                              {% endif %}
                                  {{ task.status }} </span>{% if task.status == "Completed" %}{{ task.completed_on }} {% endif %} </li>
                          {% endfor %}
                      </ul>
                      {% else %} 
                      <p>No tasks assigned.</p>
                      {% endif %}
                  </div>
              </div>
          </div>

        {% endfor %}


        <div class="card mb-3">

        </div>
    </div>
</div>

<script>
  document.getElementById('filter-open').addEventListener('click', function() {
      var projects = document.querySelectorAll('.project');
      projects.forEach(function(project) {
          if (project.getAttribute('data-status') !== 'Open') {
              project.style.display = 'none';
          } else {
              project.style.display = 'block';
          }
      });
  });
  </script>
{% endblock %}
